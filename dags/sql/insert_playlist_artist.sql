insert into public.playlists_artists 
with base_artista as 
(
select 
cast(regexp_matches(track_1,'user:.+?}') as varchar) as user_id,
cast(regexp_matches(track_1,'name.+?,') as varchar) as artista_1,
cast(regexp_matches(track_2,'name.+?,') as varchar) as artista_2,
cast(regexp_matches(track_3,'name.+?,') as varchar) as artista_3,
cast(regexp_matches(track_4,'name.+?,') as varchar) as artista_4,
cast(regexp_matches(track_5,'name.+?,') as varchar) as artista_5,
cast(regexp_matches(track_6,'name.+?,') as varchar) as artista_6,
cast(regexp_matches(track_7,'name.+?,') as varchar) as artista_7,
cast(regexp_matches(track_8,'name.+?,') as varchar) as artista_8,
cast(regexp_matches(track_9,'name.+?,') as varchar) as artista_9,
cast(regexp_matches(track_10,'name.+?,') as varchar) as artista_10,
cast(regexp_matches(track_11,'name.+?,') as varchar) as artista_11,
cast(regexp_matches(track_12,'name.+?,') as varchar) as artista_12,
cast(regexp_matches(track_13,'name.+?,') as varchar) as artista_13,
cast(regexp_matches(track_14,'name.+?,') as varchar) as artista_14,
cast(regexp_matches(track_15,'name.+?,') as varchar) as artista_15,
cast(regexp_matches(track_16,'name.+?,') as varchar) as artista_16,
cast(regexp_matches(track_17,'name.+?,') as varchar) as artista_17,
cast(regexp_matches(track_18,'name.+?,') as varchar) as artista_18,
cast(regexp_matches(track_19,'name.+?,') as varchar) as artista_19,
cast(regexp_matches(track_20,'name.+?,') as varchar) as artista_20,
cast(regexp_matches(track_21,'name.+?,') as varchar) as artista_21,
cast(regexp_matches(track_22,'name.+?,') as varchar) as artista_22,
cast(regexp_matches(track_23,'name.+?,') as varchar) as artista_23,
cast(regexp_matches(track_24,'name.+?,') as varchar) as artista_24,
cast(regexp_matches(track_25,'name.+?,') as varchar) as artista_25,
cast(regexp_matches(track_26,'name.+?,') as varchar) as artista_26,
cast(regexp_matches(track_27,'name.+?,') as varchar) as artista_27,
cast(regexp_matches(track_28,'name.+?,') as varchar) as artista_28,
cast(regexp_matches(track_29,'name.+?,') as varchar) as artista_29,
cast(regexp_matches(track_30,'name.+?,') as varchar) as artista_30,
cast(regexp_matches(track_31,'name.+?,') as varchar) as artista_31,
cast(regexp_matches(track_32,'name.+?,') as varchar) as artista_32,
cast(regexp_matches(track_33,'name.+?,') as varchar) as artista_33,
cast(regexp_matches(track_34,'name.+?,') as varchar) as artista_34,
cast(regexp_matches(track_35,'name.+?,') as varchar) as artista_35,
cast(regexp_matches(track_36,'name.+?,') as varchar) as artista_36,
cast(regexp_matches(track_37,'name.+?,') as varchar) as artista_37,
cast(regexp_matches(track_38,'name.+?,') as varchar) as artista_38,
cast(regexp_matches(track_39,'name.+?,') as varchar) as artista_39,
cast(regexp_matches(track_40,'name.+?,') as varchar) as artista_40,
cast(regexp_matches(track_41,'name.+?,') as varchar) as artista_41,
cast(regexp_matches(track_42,'name.+?,') as varchar) as artista_42,
cast(regexp_matches(track_43,'name.+?,') as varchar) as artista_43,
cast(regexp_matches(track_44,'name.+?,') as varchar) as artista_44,
cast(regexp_matches(track_45,'name.+?,') as varchar) as artista_45,
cast(regexp_matches(track_46,'name.+?,') as varchar) as artista_46,
cast(regexp_matches(track_47,'name.+?,') as varchar) as artista_47,
cast(regexp_matches(track_48,'name.+?,') as varchar) as artista_48,
cast(regexp_matches(track_49,'name.+?,') as varchar) as artista_49,
cast(regexp_matches(track_50,'name.+?,') as varchar) as artista_50
from staging.playlist_file 
)
select 
substring(user_id,8,length(user_id) -11) as user_id,
substring(cast(regexp_matches(artista_1,':.+,') as varchar),6,length(artista_1)-14) as artista_1,
substring(cast(regexp_matches(artista_2,':.+,') as varchar),6,length(artista_2)-14) as artista_2,
substring(cast(regexp_matches(artista_3,':.+,') as varchar),6,length(artista_3)-14) as artista_3,
substring(cast(regexp_matches(artista_4,':.+,') as varchar),6,length(artista_4)-14) as artista_4,
substring(cast(regexp_matches(artista_5,':.+,') as varchar),6,length(artista_5)-14) as artista_5,
substring(cast(regexp_matches(artista_6,':.+,') as varchar),6,length(artista_6)-14) as artista_6,
substring(cast(regexp_matches(artista_7,':.+,') as varchar),6,length(artista_7)-14) as artista_7,
substring(cast(regexp_matches(artista_8,':.+,') as varchar),6,length(artista_8)-14) as artista_8,
substring(cast(regexp_matches(artista_9,':.+,') as varchar),6,length(artista_9)-14) as artista_9,
substring(cast(regexp_matches(artista_10,':.+,') as varchar),6,length(artista_10)-14) as artista_10,
substring(cast(regexp_matches(artista_11,':.+,') as varchar),6,length(artista_11)-14) as artista_11,
substring(cast(regexp_matches(artista_12,':.+,') as varchar),6,length(artista_12)-14) as artista_12,
substring(cast(regexp_matches(artista_13,':.+,') as varchar),6,length(artista_13)-14) as artista_13,
substring(cast(regexp_matches(artista_14,':.+,') as varchar),6,length(artista_14)-14) as artista_14,
substring(cast(regexp_matches(artista_15,':.+,') as varchar),6,length(artista_15)-14) as artista_15,
substring(cast(regexp_matches(artista_16,':.+,') as varchar),6,length(artista_16)-14) as artista_16,
substring(cast(regexp_matches(artista_17,':.+,') as varchar),6,length(artista_17)-14) as artista_17,
substring(cast(regexp_matches(artista_18,':.+,') as varchar),6,length(artista_18)-14) as artista_18,
substring(cast(regexp_matches(artista_19,':.+,') as varchar),6,length(artista_19)-14) as artista_19,
substring(cast(regexp_matches(artista_20,':.+,') as varchar),6,length(artista_20)-14) as artista_20,
substring(cast(regexp_matches(artista_21,':.+,') as varchar),6,length(artista_21)-14) as artista_21,
substring(cast(regexp_matches(artista_22,':.+,') as varchar),6,length(artista_22)-14) as artista_22,
substring(cast(regexp_matches(artista_23,':.+,') as varchar),6,length(artista_23)-14) as artista_23,
substring(cast(regexp_matches(artista_24,':.+,') as varchar),6,length(artista_24)-14) as artista_24,
substring(cast(regexp_matches(artista_25,':.+,') as varchar),6,length(artista_25)-14) as artista_25,
substring(cast(regexp_matches(artista_26,':.+,') as varchar),6,length(artista_26)-14) as artista_26,
substring(cast(regexp_matches(artista_27,':.+,') as varchar),6,length(artista_27)-14) as artista_27,
substring(cast(regexp_matches(artista_28,':.+,') as varchar),6,length(artista_28)-14) as artista_28,
substring(cast(regexp_matches(artista_29,':.+,') as varchar),6,length(artista_29)-14) as artista_29,
substring(cast(regexp_matches(artista_30,':.+,') as varchar),6,length(artista_30)-14) as artista_30,
substring(cast(regexp_matches(artista_31,':.+,') as varchar),6,length(artista_31)-14) as artista_31,
substring(cast(regexp_matches(artista_32,':.+,') as varchar),6,length(artista_32)-14) as artista_32,
substring(cast(regexp_matches(artista_33,':.+,') as varchar),6,length(artista_33)-14) as artista_33,
substring(cast(regexp_matches(artista_34,':.+,') as varchar),6,length(artista_34)-14) as artista_34,
substring(cast(regexp_matches(artista_35,':.+,') as varchar),6,length(artista_35)-14) as artista_35,
substring(cast(regexp_matches(artista_36,':.+,') as varchar),6,length(artista_36)-14) as artista_36,
substring(cast(regexp_matches(artista_37,':.+,') as varchar),6,length(artista_37)-14) as artista_37,
substring(cast(regexp_matches(artista_38,':.+,') as varchar),6,length(artista_38)-14) as artista_38,
substring(cast(regexp_matches(artista_39,':.+,') as varchar),6,length(artista_39)-14) as artista_39,
substring(cast(regexp_matches(artista_40,':.+,') as varchar),6,length(artista_40)-14) as artista_40,
substring(cast(regexp_matches(artista_41,':.+,') as varchar),6,length(artista_41)-14) as artista_41,
substring(cast(regexp_matches(artista_42,':.+,') as varchar),6,length(artista_42)-14) as artista_42,
substring(cast(regexp_matches(artista_43,':.+,') as varchar),6,length(artista_43)-14) as artista_43,
substring(cast(regexp_matches(artista_44,':.+,') as varchar),6,length(artista_44)-14) as artista_44,
substring(cast(regexp_matches(artista_45,':.+,') as varchar),6,length(artista_45)-14) as artista_45,
substring(cast(regexp_matches(artista_46,':.+,') as varchar),6,length(artista_46)-14) as artista_46,
substring(cast(regexp_matches(artista_47,':.+,') as varchar),6,length(artista_47)-14) as artista_47,
substring(cast(regexp_matches(artista_48,':.+,') as varchar),6,length(artista_48)-14) as artista_48,
substring(cast(regexp_matches(artista_49,':.+,') as varchar),6,length(artista_49)-14) as artista_49,
substring(cast(regexp_matches(artista_50,':.+,') as varchar),6,length(artista_50)-14) as artista_50
from base_artista 